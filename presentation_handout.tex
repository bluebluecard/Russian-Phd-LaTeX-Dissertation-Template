\newif\ifpresentation % Condition checking that the document is a presentation
\presentationtrue
% If you need vertical slide layout, replace landscape with portrait
% and adjust dimensions in \includeslide
\documentclass[a4paper,14pt,oneside,landscape]{memoir}
\pagestyle{plain}
\usepackage[a4paper, top=0.5cm, bottom=1.5cm, left=0.5cm, right=0.5cm, nohead, nomarginpar]{geometry}
\usepackage{graphicx}

\providecommand*\autodot{} % quick fix for polyglossia 1.50
\usepackage{polyglossia}[2014/05/21]

\usepackage{pgffor}

\newif\ifxetexorluatex   % define a new conditional operator (http://tex.stackexchange.com/a/47579)
\ifxetex
    \xetexorluatextrue
\else
    \ifluatex
        \xetexorluatextrue
    \else
        \xetexorluatexfalse
    \fi
\fi

\input{common/setup}
\input{common/fonts}

\setlength{\parindent}{0pt}

% \includeslide[comment]{page_number}: command to add a slide with a comment
% page_number: page number in presentation.pdf
% comment: slide comment (optional)
%
% By default, this file places 2 slides per page with a small gap.
% Change 0.49\columnwidth in \begin{minipage} and width=\columnwidth in \includegraphics,
% to tune the dimensions.
% For example, to place slides in one column, replace 0.49\columnwidth with
% 0.99\columnwidth.
\newcommand{\includeslide}[2][{}]{%
\begin{minipage}[t]{0.49\columnwidth}\centering\frame{%
\includegraphics[page=#2,width=\columnwidth]{presentation}}%
\par\raggedright{#1}\end{minipage}}


\begin{document}
% Slide with comment
\includeslide[Use captions under slides to clarify slide content.
For example, explain graph labels that are only spoken aloud.]{1}
\hfill
% Slide without comment
\includeslide{2}

% If many consecutive slides have no comments, you can add them using a loop
% Below, 3/5, 6/7, etc. are page numbers in presentation.pdf, placed
% on the left and right respectively
\foreach \pga / \pgb in {3/5,6/7,8/9,10/11,12/13} {
    \includeslide{\pga}
    \hfill
    \includeslide{\pgb}
}

\includeslide[This slide shows the operation scheme of a charged-particle accelerator with delayed current
pulse.
Blue shows the envelope of the incident wave, red shows oscillations in the accelerating section.]{12}
\hfill
\includeslide{13}

\foreach \pga / \pgb in {14/15,17/18} {
    \includeslide{\pga}
    \hfill
    \includeslide{\pgb}
}

\includeslide[This slide presents Maxwell equations in the time domain.]{19}
\hfill
\includeslide[This slide presents Maxwell equations in the frequency domain.]{20}

\foreach \pga / \pgb in {21/22,23/24,25/26,27/28,29/30} {
    \includeslide{\pga}
    \hfill
    \includeslide{\pgb}
}

% Place a single slide at the page center
\centering
\includeslide{31}

\end{document}
